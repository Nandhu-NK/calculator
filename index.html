<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Material Estimator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f4f7fb;
      color: #333;
    }
    header {
      background: #004d99;
      color: white;
      padding: 20px;
      text-align: center;
      font-size: 28px;
      font-weight: bold;
    }
    .container {
      padding: 20px;
      max-width: 1200px;
      margin: auto;
    }
    .customer-info label {
      display: inline-block;
      width: 150px;
      margin-top: 10px;
    }
    .customer-info input {
      margin-top: 10px;
      padding: 6px;
      width: 250px;
    }
    .project-selector {
      display: flex;
      justify-content: center;
      margin: 30px 0;
      gap: 20px;
    }
    .card {
      flex: 1;
      padding: 20px;
      border-radius: 12px;
      text-align: center;
      cursor: pointer;
      transition: transform 0.3s;
      color: white;
      font-size: 18px;
      font-weight: bold;
    }
    .card:hover { transform: scale(1.05); }
    .house { background: #4CAF50; }
    .industry { background: #f39c12; }
    .solar { background: #e74c3c; }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 10px;
      text-align: center;
    }
    th { background: #004d99; color: white; }
    select, input[type='number'] {
      padding: 6px;
      width: 100%;
    }
    .controls {
      margin: 20px 0;
      text-align: right;
    }
    .btn {
      padding: 10px 15px;
      margin-left: 10px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
    }
    .btn-add { background: #4CAF50; color: white; }
    .btn-download { background: #2196F3; color: white; }
    .search-sort {
      display: flex;
      justify-content: space-between;
      margin: 20px 0;
    }
    .search-sort input, .search-sort select {
      padding: 8px;
      width: 48%;
    }
  </style>
</head>
<body>
  <header>Material Estimator</header>
  <div class="container">
    <div class="customer-info">
      <label>Customer Name:</label><input type="text"><br>
      <label>Mobile No:</label><input type="text"><br>
      <label>Location:</label><input type="text"><br>
      <label>Electrician Name:</label><input type="text"><br>
      <label>Date:</label><input type="date"><br>
    </div>

    <h2 style="margin-top:30px;">Select Project Type</h2>
    <div class="project-selector">
      <div class="card house" onclick="loadMaterials('house')">üè† House Wiring</div>
      <div class="card industry" onclick="loadMaterials('industry')">üè≠ Industrial Wiring</div>
      <div class="card solar" onclick="loadMaterials('solar')">‚òÄÔ∏è Solar Panel Design</div>
    </div>

    <div class="search-sort">
      <input type="text" id="searchBox" placeholder="Search material..." onkeyup="searchMaterial()">
      <select id="sortOptions" onchange="sortTable()">
        <option value="">Sort By</option>
        <option value="material">Material</option>
        <option value="rating">Rating</option>
      </select>
    </div>

    <div class="controls">
      <button class="btn btn-add" onclick="addRow()">+ Add Material</button>
      <button class="btn btn-download" onclick="downloadPDF()">‚¨á Save as PDF</button>
    </div>

    <table id="materialTable">
      <thead>
        <tr>
          <th>Material</th>
          <th>Rating</th>
          <th>Quantity</th>
          <th>Rate (Optional)</th>
          <th>Total</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    const materials = {
      house: [
        {name:"Switch 6A", rating:["6A","10A"]},
        {name:"Socket 16A", rating:["16A","20A"]},
        {name:"Ceiling Fan", rating:["60W","75W","100W"]},
        {name:"LED Bulb", rating:["5W","9W","12W"]},
        {name:"MCB", rating:["6A","16A","32A"]},
        {name:"1 Sqmm Wire", rating:["90m Coil","180m Coil"]},
        {name:"2.5 Sqmm Wire", rating:["90m Coil","180m Coil"]},
        {name:"Regulator", rating:["2 Step","5 Step"]},
        {name:"Tube Light", rating:["18W","36W"]},
        {name:"Main Switch", rating:["32A","63A"]},
        // ...extend up to 100
      ],
      industry: [
        {name:"3 Phase Motor", rating:["1HP","3HP","5HP","10HP"]},
        {name:"Industrial MCB", rating:["32A","63A","100A"]},
        {name:"Contactor", rating:["9A","18A","25A","32A"]},
        {name:"Overload Relay", rating:["5-8A","9-14A","20-32A"]},
        {name:"Cable 10 Sqmm", rating:["Single Core","Multi Core"]},
        {name:"Busbar", rating:["100A","200A","400A"]},
        {name:"Distribution Box", rating:["4 Way","8 Way","12 Way"]},
        {name:"Panel Meter", rating:["Analog","Digital"]},
        {name:"MCB Box", rating:["SPN","TPN"]},
        {name:"Industrial Plug", rating:["16A","32A","63A"]},
        // ...extend up to 100
      ],
      solar: [
        {name:"Solar Panel", rating:["100W","200W","300W","500W"]},
        {name:"Charge Controller", rating:["12V","24V","48V"]},
        {name:"Battery", rating:["100Ah","150Ah","200Ah"]},
        {name:"Inverter", rating:["1kW","2kW","5kW"]},
        {name:"MC4 Connector", rating:["Male","Female"]},
        {name:"DC Cable", rating:["2.5 Sqmm","4 Sqmm","6 Sqmm"]},
        {name:"Earthing Kit", rating:["Copper","GI"]},
        {name:"Junction Box", rating:["2 in 2 out","4 in 4 out"]},
        {name:"Solar Pump", rating:["1HP","3HP"]},
        {name:"Solar Street Light", rating:["12W","24W","40W"]},
        // ...extend up to 100
      ]
    };

    let currentMaterials = [];

    function loadMaterials(type) {
      currentMaterials = materials[type];
      const tbody = document.querySelector("#materialTable tbody");
      tbody.innerHTML = "";
      addRow();
    }

    function addRow() {
      const tbody = document.querySelector("#materialTable tbody");
      const row = document.createElement("tr");

      // Material dropdown
      const materialCell = document.createElement("td");
      const materialSelect = document.createElement("select");
      materialSelect.onchange = function(){ updateRating(this, ratingSelect); };
      currentMaterials.forEach(m => {
        const opt = document.createElement("option");
        opt.value = m.name;
        opt.textContent = m.name;
        materialSelect.appendChild(opt);
      });
      materialCell.appendChild(materialSelect);
      row.appendChild(materialCell);

      // Rating dropdown
      const ratingCell = document.createElement("td");
      const ratingSelect = document.createElement("select");
      currentMaterials[0].rating.forEach(r => {
        const opt = document.createElement("option");
        opt.value = r;
        opt.textContent = r;
        ratingSelect.appendChild(opt);
      });
      ratingCell.appendChild(ratingSelect);
      row.appendChild(ratingCell);

      // Quantity
      const qtyCell = document.createElement("td");
      const qtyInput = document.createElement("input");
      qtyInput.type = "number";
      qtyInput.value = 1;
      qtyInput.min = 1;
      qtyInput.oninput = function(){ updateTotal(row); };
      qtyCell.appendChild(qtyInput);
      row.appendChild(qtyCell);

      // Rate
      const rateCell = document.createElement("td");
      const rateInput = document.createElement("input");
      rateInput.type = "number";
      rateInput.placeholder = "Optional";
      rateInput.oninput = function(){ updateTotal(row); };
      rateCell.appendChild(rateInput);
      row.appendChild(rateCell);

      // Total
      const totalCell = document.createElement("td");
      totalCell.textContent = "0";
      row.appendChild(totalCell);

      tbody.appendChild(row);
      updateTotal(row);
    }

    function updateRating(materialSelect, ratingSelect) {
      const selected = currentMaterials.find(m => m.name === materialSelect.value);
      ratingSelect.innerHTML = "";
      selected.rating.forEach(r => {
        const opt = document.createElement("option");
        opt.value = r;
        opt.textContent = r;
        ratingSelect.appendChild(opt);
      });
    }

    function updateTotal(row) {
      const qty = row.cells[2].querySelector("input").value;
      const rate = row.cells[3].querySelector("input").value;
      const totalCell = row.cells[4];
      totalCell.textContent = (qty && rate) ? qty * rate : 0;
    }

    function searchMaterial() {
      const filter = document.getElementById("searchBox").value.toUpperCase();
      const rows = document.querySelector("#materialTable tbody").rows;
      for (let i = 0; i < rows.length; i++) {
        const txt = rows[i].cells[0].querySelector("select").value;
        rows[i].style.display = txt.toUpperCase().indexOf(filter) > -1 ? "" : "none";
      }
    }

    function sortTable() {
      const option = document.getElementById("sortOptions").value;
      const rows = Array.from(document.querySelector("#materialTable tbody").rows);
      if(option === "material") {
        rows.sort((a,b)=> a.cells[0].querySelector("select").value.localeCompare(b.cells[0].querySelector("select").value));
      } else if(option === "rating") {
        rows.sort((a,b)=> a.cells[1].querySelector("select").value.localeCompare(b.cells[1].querySelector("select").value));
      }
      rows.forEach(r=> document.querySelector("#materialTable tbody").appendChild(r));
    }

    function downloadPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      doc.text("Material Estimator Report", 20, 20);
      doc.html(document.querySelector("#materialTable"), {
        callback: function (doc) {
          doc.save("Material_Estimator.pdf");
        },
        x: 10,
        y: 30
      });
    }
  </script>
</body>
</html>
