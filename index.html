<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>⚡ Material Estimator</title>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      background: #f3f6fa;
      margin: 0;
      padding: 0;
    }
    header {
      background: linear-gradient(135deg, #0052D4, #4364F7, #6FB1FC);
      color: white;
      text-align: center;
      padding: 25px 15px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    header h1 {
      margin: 0;
      font-size: 2rem;
      letter-spacing: 1px;
    }
    header p {
      margin-top: 10px;
      font-size: 1rem;
      opacity: 0.9;
    }
    .container {
      max-width: 1100px;
      margin: 20px auto;
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.15);
    }
    h2 {
      color: #333;
      border-bottom: 2px solid #eee;
      padding-bottom: 8px;
    }
    .details input {
      margin: 8px;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      width: 220px;
    }
    .project-select {
      margin: 15px 0;
    }
    .project-select label {
      font-weight: bold;
      margin-right: 10px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }
    table th, table td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: center;
    }
    table th {
      background: #0052D4;
      color: white;
      position: sticky;
      top: 0;
    }
    input, select {
      padding: 8px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    .btn {
      padding: 10px 15px;
      margin: 8px 4px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.9rem;
      transition: 0.3s;
    }
    .btn-add { background: #28a745; color: white; }
    .btn-add:hover { background: #218838; }
    .btn-remove { background: #dc3545; color: white; }
    .btn-remove:hover { background: #c82333; }
    .btn-download { background: #007bff; color: white; }
    .btn-download:hover { background: #0056b3; }
    .grand-total {
      font-size: 1.2rem;
      text-align: right;
      margin-top: 20px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <header>
    <h1>⚡ Material Estimator</h1>
    <p>Smart way to calculate electrical materials and project cost</p>
  </header>

  <div class="container">
    <h2>Customer & Project Details</h2>
    <div class="details">
      <input type="text" placeholder="Customer Name">
      <input type="text" placeholder="Mobile Number">
      <input type="text" placeholder="Location">
      <input type="text" placeholder="Electrician Name">
      <input type="date">
    </div>

    <div class="project-select">
      <label>Select Project Type:</label>
      <select id="projectType" onchange="updateProjectMaterials()">
        <option value="house">House Wiring</option>
        <option value="industrial">Industrial Wiring</option>
        <option value="solar">Solar Panel Design</option>
      </select>
    </div>

    <h2>Materials List</h2>
    <table id="materialsTable">
      <thead>
        <tr>
          <th>Material</th>
          <th>Rating</th>
          <th>Quantity</th>
          <th>Rate (₹)</th>
          <th>Total (₹)</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody id="tableBody">
      </tbody>
    </table>
    <button class="btn btn-add" onclick="addRow()">+ Add Material</button>
    <button class="btn btn-download" onclick="downloadPDF()">⬇ Save as PDF</button>

    <div class="grand-total" id="grandTotal">Grand Total: ₹0</div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
  <script>
    // Materials categorized by project type
    const projectMaterials = {
      house: [
        "1.5 sqmm Wire (Red)", "1.5 sqmm Wire (Black)", "Socket 6A", "Socket 16A", 
        "Switch 6A", "Switch 16A", "Regulator", "Fan 48 Inch", "LED Bulb 9W", "Tube Light 20W"
      ],
      industrial: [
        "4 sqmm Wire", "6 sqmm Wire", "10 sqmm Wire", "32A MCB", "63A MCB", "100A MCB", 
        "Distribution Box 8 Way", "Main Switch 100A", "Starter 5HP", "Contactor 25A"
      ],
      solar: [
        "Solar Panel 250W", "Solar Panel 350W", "Solar Inverter 2kW", "Solar Inverter 5kW", 
        "Battery 150Ah", "Battery 200Ah", "MCB 32A", "MCB 63A", "DC Wire 4 sqmm", "DC Wire 6 sqmm"
      ]
    };

    // Ratings mapped to each material type
    const materialRatings = {
      "1.5 sqmm Wire (Red)": ["1.5 sqmm"],
      "1.5 sqmm Wire (Black)": ["1.5 sqmm"],
      "4 sqmm Wire": ["4 sqmm"],
      "6 sqmm Wire": ["6 sqmm"],
      "10 sqmm Wire": ["10 sqmm"],
      "Socket 6A": ["6A"],
      "Socket 16A": ["16A"],
      "Switch 6A": ["6A"],
      "Switch 16A": ["16A"],
      "LED Bulb 9W": ["9W"],
      "Tube Light 20W": ["20W"],
      "32A MCB": ["32A"],
      "63A MCB": ["63A"],
      "100A MCB": ["100A"],
      "Starter 5HP": ["5 HP"],
      "Contactor 25A": ["25A"],
      "Solar Panel 250W": ["250W"],
      "Solar Panel 350W": ["350W"],
      "Solar Inverter 2kW": ["2 kW"],
      "Solar Inverter 5kW": ["5 kW"],
      "Battery 150Ah": ["150Ah"],
      "Battery 200Ah": ["200Ah"],
      "DC Wire 4 sqmm": ["4 sqmm"],
      "DC Wire 6 sqmm": ["6 sqmm"]
    };

    let currentMaterials = projectMaterials.house; // default

    function updateProjectMaterials() {
      const type = document.getElementById("projectType").value;
      currentMaterials = projectMaterials[type];
      document.getElementById("tableBody").innerHTML = ""; // reset table
    }

    function addRow() {
      const tableBody = document.getElementById("tableBody");
      const row = document.createElement("tr");

      row.innerHTML = `
        <td>
          <select onchange="updateRatings(this)">
            ${currentMaterials.map(m => `<option value="${m}">${m}</option>`).join("")}
          </select>
        </td>
        <td>
          <select class="ratingSelect"></select>
        </td>
        <td><input type="number" min="1" value="1" onchange="updateTotal(this)"></td>
        <td><input type="number" min="0" value="0" onchange="updateTotal(this)"></td>
        <td class="total">0</td>
        <td><button class="btn btn-remove" onclick="removeRow(this)">X</button></td>
      `;
      tableBody.appendChild(row);

      // initialize rating for first material
      updateRatings(row.querySelector("select"));
    }

    function updateRatings(selectEl) {
      const material = selectEl.value;
      const ratingSelect = selectEl.closest("tr").querySelector(".ratingSelect");
      const ratings = materialRatings[material] || ["N/A"];
      ratingSelect.innerHTML = ratings.map(r => `<option value="${r}">${r}</option>`).join("");
    }

    function removeRow(btn) {
      btn.closest("tr").remove();
      updateGrandTotal();
    }

    function updateTotal(input) {
      const row = input.closest("tr");
      const qty = row.querySelectorAll("input")[0].value || 0;
      const rate = row.querySelectorAll("input")[1].value || 0;
      const total = qty * rate;
      row.querySelector(".total").innerText = total;
      updateGrandTotal();
    }

    function updateGrandTotal() {
      let total = 0;
      document.querySelectorAll(".total").forEach(td => total += parseFloat(td.innerText || 0));
      document.getElementById("grandTotal").innerText = "Grand Total: ₹" + total;
    }

    function downloadPDF() {
      const element = document.querySelector(".container");
      html2pdf().from(element).set({
        margin: 10,
        filename: 'Material_Estimate.pdf',
        html2canvas: { scale: 2 },
        jsPDF: { orientation: 'portrait' }
      }).save();
    }
  </script>
</body>
</html>
